<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rust Crafting Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 700px; margin: 2rem auto; line-height: 1.6; }
    label { display: block; margin-top: 1rem; }
    input[type="number"] { width: 100px; }
    .output { background: #f0f0f0; padding: 1rem; margin-top: 1.5rem; border-radius: 4px; }
    .details { display: none; margin-top: 1rem; padding: 0.5rem; background: #fff; border: 1px solid #ccc; border-radius: 5px; }
    .visible { display: block; }
  </style>
</head>
<body>
  <h1>Rust Crafting Calculator</h1>

  <h2>Inventory Inputs</h2>
  <div>
    <label>Wood: <input type="number" id="wood" min="0" value="0" /></label>
    <label>Sulfur Ore: <input type="number" id="sulfurOre" min="0" value="0" /></label>
    <label>Metal Ore: <input type="number" id="metalOre" min="0" value="0" /></label>
    <label>Charcoal: <input type="number" id="charcoal" min="0" value="0" /></label>
    <label>Sulfur: <input type="number" id="Sulfur" min="0" value="0" /></label>
    <label>Gunpowder: <input type="number" id="gunpowder" min="0" value="0" /></label>
    <label>Metal Fragments: <input type="number" id="metalFragments" min="0" value="0" /></label>
    <label>Beancan Grenades: <input type="number" id="beancan" min="0" value="0" /></label>
    <label>Explosives: <input type="number" id="explosives" min="0" value="0" /></label>
    <label>Cloth: <input type="number" id="cloth" min="0" value="0" /></label>
    <label>Rope: <input type="number" id="rope" min="0" value="0" /></label>
    <label>Small Stash: <input type="number" id="smallStash" min="0" value="0" /></label>
    <label>Pipe: <input type="number" id="pipe" min="0" value="0" /></label>
    <label>Low Grade Fuel: <input type="number" id="lgf" min="0" value="0" /></label>
  </div>

  <div class="output">
    <h2>Craft Options</h2>
    <label><input type="checkbox" id="craftSatchel"> Craft Satchels</label>
    <div id="satchelDetails" class="details">
      <strong>Requirements:</strong>
      <ul>
        <li>4 Beancan Grenades</li>
        <li>1 Small Stash</li>
        <li>1 Rope</li>
        <li>Each Beancan: 60 Gunpowder + 20 Fragments</li>
      </ul>
      <label>How many Satchels to craft: <input type="number" id="desiredSatchels" min="0" value="0"></label>
      <p>Beancan Crafted: <span id="beancanMade">0</span></p>
      <p>Satchels Crafted: <span id="satchelMade">0</span></p>
    </div>

    <label><input type="checkbox" id="craftRocket"> Craft Rockets</label>
    <div id="rocketDetails" class="details">
      <strong>Requirements:</strong>
      <ul>
        <li>10 Explosives</li>
        <li>150 Gunpowder</li>
        <li>2 Pipes</li>
        <li>Each Explosive: 50 Gunpowder, 10 Sulfur, 10 Fragments, 3 LGF</li>
      </ul>
      <label>How many Rockets to craft: <input type="number" id="desiredRockets" min="0" value="0"></label>
      <p>Explosives Crafted: <span id="explosivesMade">0</span></p>
      <p>Rockets Crafted: <span id="rocketMade">0</span></p>
    </div>

    <h3>Remaining Inventory</h3>
    <p>Sulfur: <span id="remainSulfur">0</span></p>
    <p>Charcoal: <span id="remainCharcoal">0</span></p>
    <p>Gunpowder: <span id="remainGunpowder">0</span></p>
    <p>Fragments: <span id="remainFragments">0</span></p>
    <p>Beancan Grenades: <span id="remainBeancan">0</span></p>
    <p>Stashes: <span id="remainStash">0</span></p>
    <p>Rope: <span id="remainRope">0</span></p>
    <p>Pipes: <span id="remainPipe">0</span></p>
    <p>Explosives: <span id="remainExplosives">0</span></p>
    <p>Low Grade Fuel: <span id="remainLGF">0</span></p>
  </div>

  <script>
    const inputs = ['wood','sulfurOre','metalOre','charcoal','Sulfur','gunpowder','metalFragments','beancan','explosives','cloth','rope','smallStash','pipe','lgf','desiredSatchels','desiredRockets'];
    inputs.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.addEventListener('input', update);
    });
    document.getElementById('craftSatchel').addEventListener('change', () => {
      document.getElementById('satchelDetails').classList.toggle('visible');
      update();
    });
    document.getElementById('craftRocket').addEventListener('change', () => {
      document.getElementById('rocketDetails').classList.toggle('visible');
      update();
    });

    function update() {
      const get = id => +document.getElementById(id)?.value || 0;
      const satchelChecked = document.getElementById('craftSatchel').checked;
      const rocketChecked = document.getElementById('craftRocket').checked;

      const sulfurOre = get('sulfurOre'), wood = get('wood');
      const sulfurFromOre = Math.min(sulfurOre, Math.floor(wood * 2.5));
      let sulfur = get('Sulfur') + sulfurFromOre;
      let charcoal = get('charcoal');

      let gunpowder = get('gunpowder');
      let fragments = get('metalFragments') + get('metalOre');
      let beancan = get('beancan');
      let stash = get('smallStash') + Math.floor(get('cloth') / 10);
      let rope = get('rope');
      let explosives = get('explosives');
      let pipe = get('pipe');
      let lgf = get('lgf');

      let craftableGunpowder = Math.min(Math.floor(sulfur / 2), Math.floor(charcoal / 3));
      gunpowder += craftableGunpowder;
      sulfur -= craftableGunpowder * 2;
      charcoal -= craftableGunpowder * 3;

      let explosivesMade = 0;
      let rocketCount = 0;
      if (rocketChecked) {
        const desiredRockets = get('desiredRockets');
        const requiredExplosives = desiredRockets * 10;
        const requiredGunpowder = desiredRockets * 150;
        const requiredPipes = desiredRockets * 2;

        const possibleExplosives = Math.floor(Math.min(
          gunpowder / 50,
          sulfur / 10,
          fragments / 10,
          lgf / 3
        ));
        const makeExplosives = Math.min(requiredExplosives, possibleExplosives);

        gunpowder -= makeExplosives * 50;
        sulfur -= makeExplosives * 10;
        fragments -= makeExplosives * 10;
        lgf -= makeExplosives * 3;
        explosives += makeExplosives;
        explosivesMade = makeExplosives;

        const possibleRockets = Math.floor(Math.min(explosives / 10, gunpowder / 150, pipe / 2));
        rocketCount = Math.min(possibleRockets, desiredRockets);

        explosives -= rocketCount * 10;
        gunpowder -= rocketCount * 150;
        pipe -= rocketCount * 2;
      }

      let beancanMade = 0;
      let satchelCount = 0;
      if (satchelChecked) {
        const desiredSatchels = get('desiredSatchels');
        const requiredBeancans = desiredSatchels * 4;

        const possibleBeancans = Math.floor(Math.min(gunpowder / 60, fragments / 20));
        beancanMade = Math.min(possibleBeancans, requiredBeancans - beancan);

        gunpowder -= beancanMade * 60;
        fragments -= beancanMade * 20;
        beancan += beancanMade;

        const possibleSatchels = Math.floor(Math.min(beancan / 4, stash, rope));
        satchelCount = Math.min(possibleSatchels, desiredSatchels);

        beancan -= satchelCount * 4;
        stash -= satchelCount;
        rope -= satchelCount;
      }

      const set = (id, val) => document.getElementById(id).innerText = Math.max(0, Math.floor(val));
      set('remainSulfur', sulfur);
      set('remainCharcoal', charcoal);
      set('remainGunpowder', gunpowder);
      set('remainFragments', fragments);
      set('remainBeancan', beancan);
      set('remainStash', stash);
      set('remainRope', rope);
      set('remainPipe', pipe);
      set('remainExplosives', explosives);
      set('remainLGF', lgf);
      set('beancanMade', beancanMade);
      set('satchelMade', satchelCount);
      set('explosivesMade', explosivesMade);
      set('rocketMade', rocketCount);
    }

    update();
  </script>
</body>
</html>
